# Copyright (c) 2020, Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
title: "F1 Simulator Resource Manager Stack"
stackDescription: "F1SIM"
schemaVersion: 1.1.0
version: "20200301"
locale: "en"

variableGroups:
  - title: "Hidden"
    visible: false
    variables:
    - tenancy_ocid
    - region
    - compartment_ocid
    - INSTALL_HOME
    - freeform_tags
    
  - title: "General Configuration"
    visible: true  
    variables:
    - customer_contacts
    - package_baseurl
    - package_install

  - title: "Autonomous Database Provisioning"
    visible: true  
    variables:
    - create_database
    - ADB_NAME
    - IS_FREE_TIER
    - autonomous_database_type
    - autonomous_database_cpu_core_count
    - autonomous_database_data_storage_size_in_tbs
    - database_compartment
    - database

  - title: "Database Configuration"
    visible: true  
    variables:
    - ADMIN_PASSWORD
    - APEX_WORKSPACE
    - DB_USER
    - DB_SCHEMA
    - DB_PASSWORD

variables:
  IS_FREE_TIER:
    type: boolean
    title: "ATP Free Tier"
    required: true
    default: true
    visible:
      create_database

  ADB_NAME:
    type: string
    title: "Database Name"
    required: true
    default: "f1simdb"
    visible:
      create_database

  ADMIN_PASSWORD:
    type: password
    title: "ADMIN User Password - leave blank if random password is preferred"
    required: false
    visible: true
    default: "F1simDB123!#"

  APEX_WORKSPACE:
    type: string
    title: "APEX Workspace (for F1SIM)"
    required: true
    visible: true
    default: "LIVELAPS"

  DB_SCHEMA:
    type: string
    title: "Database Schema (for F1SIM)"
    required: true
    visible: true
    default: "SIMUSER"

  DB_USER:
    type: string
    title: "Database User (for F1SIM)"
    required: true
    visible: true
    default: "SIMUSER"

  DB_PASSWORD:
    type: password
    title: "Database Password (for Database User) - leave blank if random password is preferred"
    required: false
    visible: true
    default: "F1simDB123"

  package_install:
    type: string
    title: "Package Install"
    required: true
    visible: true
    default: "f1-simulator-cloud/f1-simulator-cloud-v5_0_0-20.tar.gz"

  package_baseurl:
    type: string
    title: "Package Repo URL"
    required: true
    visible: true
    default: "https://apigw.withoracle.cloud/livelaps/rdm/packages/"

  customer_contacts:
    type: string
    title: "Customer Contact"
    required: true
    visible: true
    default: "demo@withoracle.cloud"

  INSTALL_HOME:
    type: string
    required: true
    visible: false
    default: "."

  autonomous_database_cpu_core_count:
    type: integer
    default: 1
    minimum: 1
    maximum: 64
    title: "Autonomous Database OCPU"
    description: ""
    visible:
      and:
        - not:
          - IS_FREE_TIER
        - create_database

  autonomous_database_data_storage_size_in_tbs:
    type: integer
    default: 1
    minimum: 1
    maximum: 10
    title: "Autonomous Database Storage (TB)"
    description: ""
    visible:
      and:
        - not:
          - IS_FREE_TIER
        - create_database

  create_database:
    title: "Create New Database?"
    type: boolean

  database_compartment:
    type: oci:identity:compartment:id
    title: "Autonomous Database Compartment"
    required: false
    visible:
      not:
        - create_database

  database:
    type: oci:database:autonomousdatabase:id
    title: "Use Existing Autonomous Database"
    required: false
    dependsOn:
      compartmentId: ${database_compartment}
    visible:
      not:
        - create_database

  autonomous_database_type:
    type: enum
    title: "Workload Type"
    default: "DEFAULT"
    # enumerated values
    enum:
      - OLTP
      - DW
      - AJD
    visible:
      create_database
